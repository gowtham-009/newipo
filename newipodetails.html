<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IPO Details</title>
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .tab-titles {
      display: flex;
      margin-bottom: 10px;
      position: relative;
    }

    .tab {
      padding: 10px;
      cursor: pointer;
      flex: 1;
      text-align: center;
      /* background-color: #f1f1f1; */
      transition: background-color 0.3s;
    }

    .tab:hover {
      /* background-color: #ddd; */
    }

    /* Hide radio buttons */
    input[type="radio"] {
      display: none;
    }

    /* Tab content styling */
    /* Tab content styling */
    .tab-content .content {
      display: none;
      /* Hide all content by default */
    }

    #tab1:checked~.tab-titles~.tab-content #content1,
    #tab2:checked~.tab-titles~.tab-content #content2 {
      display: block;
      /* Show the corresponding content */
    }

    /* Border animation */
    .tab-titles {
      position: relative;
      display: flex;
      margin-bottom: 10px;
    }

    .tab-titles:before {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50%;
      /* Adjust to the number of tabs */
      height: 2px;
      background-color: #3498db;
      transition: left 0.3s ease-in-out;
    }

    #tab1:checked~.tab-titles:before {
      left: 0%;
    }

    #tab2:checked~.tab-titles:before {
      left: 50%;
    }

    .stepper {
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      padding: 20px;
    }

    .step {
      flex: 1;
      text-align: center;
      position: relative;
      padding: 10px;
      opacity: 0.5;
      transition: opacity 0.3s ease;
    }

    .step.active {
      opacity: 1;
    }

    .step-number {
      width: 30px;
      height: 30px;
      line-height: 30px;
      border-radius: 50%;
      background-color: #ccc;
      color: #fff;
      margin: 0 auto 10px;
      font-weight: bold;
    }

    .step-label {
      font-size: 14px;
      color: #333;
    }

    /* Bar between steps */
    .step::after {
      content: '';
      position: absolute;
      top: 15px;
      /* Adjust this to align with the middle of the step number */
      left: 50%;
      /* Start from the middle of the current step */
      width: 100%;
      /* Span the entire width to the next step */
      height: 2px;
      background-color: #ccc;
      z-index: -1;
    }

    /* Remove the bar after the last step */
    .step:last-child::after {
      display: none;
    }

    .step.active::after,
    .step.active~.step::after {
      background-color: #4CAF50;
      /* Green color for completed steps */
    }

    .separator {
      width: 100px;
      height: 2px;
      /* Adjust the height as needed */
      background-color: #e0e0e0;
      /* Light gray color */
      margin: 0 auto;
      /* Center the separator */
    }
  </style>
</head>

<body>
  <div class="block md:hidden max-w-4xl mx-auto bg-blue-600 sm:relative sm:h-[100px]">
    <div class="flex justify-center items-center text-center">
      <div class="w-screen">
        <div class="mx-auto  my-4 mb-20 rounded-md text-white font-bold">
          <nav class="absolute top-2 w-full">
            <!-- <div class="flex justify-between p-4 font-bold text-xl"> -->
            <div class="grid grid-cols-12 my-4">
              <!-- First SVG Icon -->
              <div class="col-span-2 flex justify-start px-5 items-center clickable-div" data-target="index.html">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6">
                  <path fill-rule="evenodd"
                    d="M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z"
                    clip-rule="evenodd" />
                </svg>
              </div>

              <!-- Text (IPO's) -->
              <div class="col-span-8 flex justify-start items-center text-lg font-semibold">
                IPO's
              </div>

              <!-- Second SVG Icon -->
              <div class="col-span-2 flex justify-end px-5 items-center">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                  stroke="currentColor" class="h-6 w-6">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                </svg>
              </div>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>
  <div class="flex justify-center items-center absolute top-12 left-0 right-0">
    <div class="rounded-md border mt-5 bg-white shadow-lg w-full max-w-4xl md:max-w-none
      
      ">
          <div class="">
        <div class="flex px-3 py-2 pt-4">
          <div
            class="size-12 flex items-center text-center justify-center  mt-4  px-2 font-semibold rounded-lg bg-white object-cover ring-1 ring-gray-900/10 ">
            IPO</div>

          <div>
            <div class="text-xl font-bold text-gray-900 px-4 py-2" id="companyName">
              Company Name
            </div>
            <div class="text-md font-bold text-gray-700 px-4" style="margin-top: -8px;">
              <span>Symbol : </span>(<span id="companysymbol"></span>)
            </div>

          </div>

        </div>
        <div class="flex gap-x-2 px-4" id="tagsContainer">
          <span id="mode"
            class="rounded-sm bg-indigo-50 px-1 py-0.5 text-[10px] font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10 flex text-center items-center"></span>
          <span id="status"
            class="rounded-sm bg-indigo-50 px-1 py-0.5 text-[10px] font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10 flex text-center items-center"></span>

        </div>
        <div class="mx-auto max-w-7xl px-4 ">
          <div class="mx-auto max-w-2xl lg:mx-0 lg:max-w-none my-2">
            <ul role="list" class="mt-6 grid grid-cols-1 gap-x-6 gap-y-8">
              <li class="overflow-hidden rounded-xl border border-gray-200 py-2">
                <div class="flex items-center gap-x-2 border-gray-900/5 py-2 px-3" >
                  <div>Investor Type</div>
                  <div>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                      stroke="currentColor" class="mt-1 h-6 w-6">
                      <path stroke-linecap="round" stroke="round"
                        d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
                    </svg>
                  </div>

                 
                </div>
               
                <div class="px-3 flex gap-x-2 mt-3" id="investorTypesContainer"></div>
                <dl class="-my-3 divide-y divide-gray-100 px-3 py-4 text-sm/6">
                  <div class="flex justify-between gap-x-4 py-3">
                    <div>
                      <dt class="text-gray-500">Bid Price</dt>
                      <dd class="text-gray-700 font-bold" id="bidPrice">
                        ₹ 0.00 - ₹ 0.00
                      </dd>
                    </div>
                    <div>
                      <dt class="text-gray-500 flex justify-end">Lot Size</dt>
                      <dd class="text-gray-700 font-bold" id="lotSize">
                        0 Shares
                      </dd>
                    </div>
                  </div>
                  <div class="flex justify-between gap-x-4 py-3">
                    <div>
                      <dt class="text-gray-500"><span id="catetype"></span> Discount</dt>
                      <dd class="text-gray-700 font-bold" id="retailDiscount">
                        ₹ 0.00
                      </dd>
                    </div>
                    <div>
                      <dt class="text-gray-500 flex justify-end">
                        Issue Size
                      </dt>
                      <dd class="text-gray-700 font-bold" id="issueSize">
                        ₹ 0.00
                      </dd>
                    </div>
                  </div>
                  <div class="flex justify-between gap-x-4 py-3 border-b border-gray-200">
                    <div>
                      <dt class="text-gray-500">Offer Type</dt>
                      <dd class="text-gray-700 font-bold" id="offerType">
                        N/A
                      </dd>
                    </div>
                    <div>
                      <dt class="text-gray-500 flex justify-end">IPO Type</dt>
                      <dd class="text-gray-700 font-bold" id="ipoType">
                        N/A
                      </dd>
                    </div>
                  </div>
                  <div class="flex justify-between rounded-md my-2">
                    <div>
                      <dt class="text-gray-500">Minimum Investment</dt>
                    </div>
                    <div>
                      <dd class="text-gray-700 font-bold" id="minimumInvestment">
                        ₹ 0.00
                      </dd>
                    </div>
                  </div>
                  <div class="flex justify-between rounded-md my-5">
                    <div>
                      <dt class="text-gray-500">Maximum Investment</dt>
                    </div>
                    <div>
                      <dd class="text-gray-700 font-bold" id="maximumInvestment">
                        ₹ 0.00
                      </dd>
                    </div>
                  </div>
                  <div>
                    <div
                      class="rounded-md bg-red-50 flex justify-center px-2 py-2 text-xs font-bold text-red-700 ring-1 ring-inset ring-red-600/10"
                      id="biddingStatus">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                          d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                      <span class="py-1 px-2 text-sm" id="biddingMessage" >Loading...</span>
                    </div>
                  </div>
                </dl>
              </li>
            </ul>
          </div>
        </div>
        <div class="bg-gray-100 h-2 my-5"></div>
        <div class="px-4">
          <div class="font-bold text-gray-700 text-xl">Important Dates</div>
          <div class="mx-auto my-2">
            <ul role="list" class="mt-6" id="importantDatesContainer"></ul>
          </div>
        </div>
        <div class="p-3 px-5">
          <div class="flex justify-between gap-x-4 py-5 p-3 rounded-md bg-gray-100">
            <div class="flex gap-x-4">
              <dt class="text-gray-500">
                <span
                  class="inline-flex items-center rounded-md bg-white px-1.5 py-0.5 text-xs font-medium text-gray-600">Day
                  1</span>
              </dt>
              <dt>
                <div class="font-medium text-gray-900">
                  Overall Subscriptions
                </div>
              </dt>
              <dd class="flex items-start gap-x-2">
                <div class="font-semibold text-green-600" id="overallSubscriptions">
                  0.00X
                </div>
              </dd>
            </div>
            <div>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="gray"
                class="h-6 w-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
              </svg>
            </div>
          </div>
        </div>

        <div class="p-3 px-5">
          <div id="aboutCompanySection">
            <div class="bg-gray-100 h-2 my-5"></div>

            <div class="font-bold text-gray-700 text-xl">
              About the Company
            </div>
            <div class="py-4" id="aboutCompany">Loading...</div>
          </div>
          <div id="objectOfIssueSection">
            <div class="font-bold text-gray-700 text-xl">
              Object of the Issue
            </div>
            <div class="pl-5 py-3" id="objectOfIssue">Loading...</div>
          </div>
        </div>

        <div class="bg-gray-100 h-2 my-5"></div>
        <div class="p-2 px-5">
          <div class="font-bold text-gray-700 text-xl">
            Shareholding Patterns
          </div>
          <div class="px-4 sm:px-6 lg:px-8">
            <div class="flow-root">
              <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
                <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                  <table class="min-w-full divide-y divide-gray-300">
                    <thead>
                      <tr>
                        <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-3">
                          Particulars
                        </th>
                        <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
                          Pre-Issue
                        </th>
                        <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
                          Post-Issue
                        </th>
                      </tr>
                    </thead>
                    <tbody class="bg-white" id="shareholdingPatternsContainer"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-gray-100 h-2 my-5"></div>
        <div id="hiddencontent">

        </div>
        <div class="p-3 px-5">
          <div class="font-bold text-gray-700 text-xl">
            Strengths and Risks
          </div>
        
          <div class="tabs">
            <input type="radio" id="tab1" name="tab" checked />
            <input type="radio" id="tab2" name="tab" />

            <div class="tab-titles">
              <label for="tab1" class="tab">Strengths</label>
              <label for="tab2" class="tab">Risks</label>
            </div>

            <div class="tab-content">
              <div class="content" id="content1">
                <div id="strengthsContainer"></div>
              </div>
              <div class="content" id="content2">
                <div id="risksContainer"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-gray-100 h-2 my-3"></div>
        <div class="px-5 py-2 pb-20">
          <div class="font-bold text-gray-700 text-xl">Company Report</div>
          <div class="mx-auto max-w-2xl lg:mx-0 lg:max-w-none my-2">
            <ul role="list" class="mt-6">
              <li class="overflow-hidden rounded-xl border border-gray-200 py-2">
                <div class="flex justify-between p-4">
                  <div>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                      stroke="red" class="h-6 w-6 my-2">
                      <path stroke-linecap="round" stroke-linejoin="round"
                        d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                    </svg>
                  </div>
                  <div>
                    <div class="font-semibold text-gray-800 text-sm" id="reportTitle">
                      Company Report
                    </div>
                    <div class="text-gray-300 text-sm">
                      <a href="#" id="reportLink">Download RHP</a>
                    </div>
                  </div>
                  <div>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                      stroke="blue" class="h-6 w-6 my-2">
                      <path stroke-linecap="round" stroke-linejoin="round"
                        d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                    </svg>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div class="bg-gray-100 h-2"></div>
       

        
      </div>
      <div class="fixed bottom-0 w-full bg-white py-4 z-50">
        <button type="button" id="applyNowButton"  onclick="redirect()"
          class="rounded-md bg-blue-800 py-4 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 focus:outline-none mx-4 w-[90%] lg:w-[55%]">
          Apply Now
        </button>
      </div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script>
    const clickableDivs = document.querySelectorAll(".clickable-div");
    clickableDivs.forEach((div) => {
      div.addEventListener("click", function () {
        const targetPage = this.getAttribute("data-target");
        window.location.href = targetPage;
      });
    });




    function getDecryptedData() {
      var urlParams = new URLSearchParams(window.location.search);
      var encryptedData = urlParams.get('data');

      if (encryptedData) {
        var secretKey = "ipodetailsdata01"; 
        var decodedData = decodeURIComponent(encryptedData);
        var bytes = CryptoJS.AES.decrypt(decodedData, secretKey);
        var decryptedJson = bytes.toString(CryptoJS.enc.Utf8);

        // Convert JSON string back to JS object
        var iporequiredDetails = JSON.parse(decryptedJson);
       return iporequiredDetails


      }
    }

    window.onload = function () {
      getDecryptedData();
      infoDetails();
    };


    const infoDetails = async () => {
  const parametersObject = getDecryptedData();

  let apiUrl = '';
  const headers = {};

  if (parametersObject.isCompanyFrom === 'NSE') {
    apiUrl = `https://ipo.gwcindia.in/nse-api/api-ipo-info.php?isin=${parametersObject.isin}&symbol=${parametersObject.ipoSymbol}`;
  } else if (parametersObject.isCompanyFrom === 'BSE') {
    apiUrl = `https://ipo.gwcindia.in/api/bse/v1/ipolist/${parametersObject.isin}`;
    headers['Authorization'] = '21279C8DC0753CD1A90DEBF3C1C5CEDB8B5B77E0455EE804C9CA03BB706CD02A';
    headers['Cookie'] = 'PHPSESSID=86ikmrbq26d8cv7lbqr7r1q07u';
  } else {
    console.error('Invalid company source');
    return;
  }

  try {
    const response = await fetch(apiUrl, {
      method: 'GET',
      headers: headers
    });

    if (!response.ok) {
      throw new Error(`Network error, please try again. Status: ${response.status}`);
    }

    const data = await response.json();

    if(data){
      datarendering(data)
    }
   
   
  } catch (error) {
    console.error('Error fetching IPO details:', error.message);
  }
};

const datarendering=(ipodetails)=>{
 if(ipodetails.nse){
  const parametersObject = getDecryptedData();

  console.log("lerj",parametersObject)

  document.getElementById('companyName').innerText=ipodetails.nse.ipoName
  document.getElementById('companysymbol').innerText=ipodetails.nse.ipoSymbol
  document.getElementById('mode').innerHTML=parametersObject.isCompanyFrom
  document.getElementById('status').innerHTML=ipodetails.nse.subType ||'N/A'
  document.getElementById('bidPrice').innerHTML="₹"+" "+ipodetails.nse.minPrice+" "+"-"+" "+"₹"+ipodetails.nse.maxPrice
  document.getElementById('lotSize').innerHTML=ipodetails.nse.lotSize+" "+"Shares"
  document.getElementById('offerType').innerHTML=ipodetails.nse.subType ||'N/A'
  document.getElementById('ipoType').innerHTML=ipodetails.nse.issueType
  document.getElementById('issueSize').innerHTML=ipodetails.nse.issueSize

 

const endDate = new Date(ipodetails.nse.biddingEndDate);

const today = new Date();

// Normalize both dates to YYYY-MM-DD (ignore time)
const normalize = date => new Date(date.getFullYear(), date.getMonth(), date.getDate());
const normalizedEndDate = normalize(endDate);
const normalizedToday = normalize(today);

// Calculate the difference in days
const diffTime = normalizedEndDate.getTime() - normalizedToday.getTime();
const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));

// Determine the message

if (diffDays === 0) {
  document.getElementById('biddingMessage').innerText = "Today";
} else if (diffDays > 0) {
  document.getElementById('biddingMessage').innerText = `${diffDays} day${diffDays > 1 ? "s" : ""} more`;
} else {
  document.getElementById('biddingMessage').innerText = `Expired ${Math.abs(diffDays)} day${Math.abs(diffDays) > 1 ? "s" : ""} ago`;
}





  if (ipodetails.nse.subCategorySettings) {
  const subCategorySettings = ipodetails.nse.subCategorySettings;
  let investortype = [];

  subCategorySettings.forEach((category) => {
  if (category.allowUpi) {
    let code = category.caCode;
    if(code==='RETAIL'){
      code="Retail"
    }
    else if (code === 'NIB') {
      code = 'HNI';

    } else if (code === 'EMPRET') {
      code = 'EMP';

    }

    if (code === 'Retail') {
      investortype.unshift(code);

    } else {
      investortype.push(code);
    }

    const hiddenContent = document.getElementById('hiddencontent');
 
    hiddenContent.innerHTML += `
    <input type="text" class="hidden"  id="${code}-discountprice" value="${category.discountPrice || '0'}">
    <input type="text" class="hidden"  id="${code}-minprice" value="${category.minValue}">
    <input type="text" class="hidden"   id="${code}-maxprice" value="${category.maxUpiLimit}">
  `;

    
  }
});

 

  const container = document.getElementById('investorTypesContainer');
  container.innerHTML = '';
  let activeButton = null; 
  investortype.forEach((type, index) => {
    const button = document.createElement('button');
    button.innerText = type;
    button.className = 'rounded-md outline-none bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm';

    button.addEventListener('click', () => {
      if (activeButton) {
        activeButton.classList.remove('bg-green-500');
        activeButton.classList.add('bg-white');
      }
      button.classList.remove('bg-white');
      button.classList.add('bg-green-500');
      activeButton = button;
     
      document.getElementById('catetype').innerHTML=type

      investmentfunction(type, ipodetails)


    });
    container.appendChild(button);
    if (index === 0) {
 
      button.click(); 
    }
  });




}

 }
 else if(ipodetails.metaData){
  console.log("this is bse")

  const parametersObject = getDecryptedData();
console.log(parametersObject)
 document.getElementById('companyName').innerText=ipodetails.metaData[parametersObject.isin].companyName
 document.getElementById('companysymbol').innerText=ipodetails.metaData[parametersObject.isin].symbol
 document.getElementById('mode').innerHTML=parametersObject.isCompanyFrom
 document.getElementById('status').innerHTML=ipodetails.metaData[parametersObject.isin].issuetype
 document.getElementById('bidPrice').innerHTML="₹"+" "+ipodetails.metaData[parametersObject.isin].floorprice+" "+"-"+" "+"₹"+ipodetails.metaData[parametersObject.isin].ceilingprice
 document.getElementById('lotSize').innerHTML=ipodetails.metaData[parametersObject.isin].tradinglot+" "+"Shares"
// document.getElementById('offerType').innerHTML=ipodetails.metaData[parametersObject.isin].subType ||'N/A'
 document.getElementById('ipoType').innerHTML=ipodetails.metaData[parametersObject.isin].issuetype
 document.getElementById('issueSize').innerHTML=ipodetails.metaData[parametersObject.isin].issuesize



 const endDate = new Date(ipodetails.metaData[parametersObject.isin].closedate);

const today = new Date();

//Normalize both dates to YYYY-MM-DD (ignore time)
const normalize = date => new Date(date.getFullYear(), date.getMonth(), date.getDate());
const normalizedEndDate = normalize(endDate);
const normalizedToday = normalize(today);

// Calculate the difference in days
const diffTime = normalizedEndDate.getTime() - normalizedToday.getTime();
const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));

// Determine the message

if (diffDays === 0) {
document.getElementById('biddingMessage').innerText = "Today";
} else if (diffDays > 0) {
document.getElementById('biddingMessage').innerText = `${diffDays} day${diffDays > 1 ? "s" : ""} more`;
} else {
document.getElementById('biddingMessage').innerText = `Expired ${Math.abs(diffDays)} day${Math.abs(diffDays) > 1 ? "s" : ""} ago`;
}





if (ipodetails.metaData[parametersObject.isin].category) {
const subCategorySettings = ipodetails.metaData[parametersObject.isin].category;
let investortype = [];

subCategorySettings.forEach((category) => {
if (category.asbanonasba=='1') {
  console.log(category.category)
  
  const hiddenContent = document.getElementById('hiddencontent');

  hiddenContent.innerHTML += `
  <input type="text" class="hidden" id="${code}-discountprice" value="${category.discountPrice || '0'}">
  <input type="text"  class="hidden" id="${code}-minprice" value="${category.minValue}">
  <input type="text"  class="hidden" id="${code}-maxprice" value="${category.maxUpiLimit}">
`;

  
}
});


const container = document.getElementById('investorTypesContainer');
container.innerHTML = '';
let activeButton = null; 
investortype.forEach((type, index) => {
  const button = document.createElement('button');
  button.innerText = type;
  button.className = 'rounded-md outline-none bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm';

  button.addEventListener('click', () => {
    if (activeButton) {
      activeButton.classList.remove('bg-green-500');
      activeButton.classList.add('bg-white');
    }
    button.classList.remove('bg-white');
    button.classList.add('bg-green-500');
    activeButton = button;
   
    document.getElementById('catetype').innerHTML=type

    investmentfunction(type, ipodetails)


  });
  container.appendChild(button);
  if (index === 0) {

    button.click(); 
  }
});




}
 }
}

let investorType;
let discountpricevalue;
let lotsvalue;
const investmentfunction = (cacode, responsedata) => {
  investorType = cacode;

  const discountInput = document.getElementById(`${cacode}-discountprice`);
  const minInput = document.getElementById(`${cacode}-minprice`);
  const maxInput = document.getElementById(`${cacode}-maxprice`);

  const discountPrice = Number(discountInput.value);
  const minPrice = Number(minInput.value);
  const maxPrice = Number(maxInput.value);
  discountpricevalue=discountPrice
  const bidPrice = Number(responsedata.nse.minPrice);
  const bidMaxPrice = Number(responsedata.nse.maxPrice);
  const lotSize = Number(responsedata.nse.lotSize);

  const minInvestmentPerLot = bidPrice * lotSize;
  const maxInvestmentPerLot = bidMaxPrice * lotSize;
  console.log(minPrice, maxPrice)
  document.getElementById('retailDiscount').innerText = "₹ " + discountPrice.toLocaleString();

  const maxLots = Math.floor(maxPrice / maxInvestmentPerLot);
  const totalMaxInvestment = maxLots * maxInvestmentPerLot;

  if (minPrice <= 0) {
    document.getElementById('minimumInvestment').innerText = `1 Lot / ₹ ${minInvestmentPerLot.toLocaleString()}`;
    document.getElementById('maximumInvestment').innerText =
      `${maxLots} ${maxLots <= 1 ? "Lot" : "Lots"} / ₹ ${totalMaxInvestment.toLocaleString()}`;
      lotsvalue=maxLots
  } else {
    let minLots = Math.floor(minPrice / minInvestmentPerLot);
    let totalMinInvestment = minLots * minInvestmentPerLot;

    // Keep incrementing until we reach or exceed minPrice
    while (totalMinInvestment < minPrice) {
      minLots++;
      totalMinInvestment = minLots * minInvestmentPerLot;
    }

    // If min exceeds max, show warning
    if (totalMinInvestment > totalMaxInvestment) {
      document.getElementById('minimumInvestment').innerText = "Invalid range: min > max";
      document.getElementById('maximumInvestment').innerText = "Please adjust values";
      return;
    }

    document.getElementById('minimumInvestment').innerText =
      `${minLots} ${minLots <= 1 ? "Lot" : "Lots"} / ₹ ${totalMinInvestment.toLocaleString()}`;

    document.getElementById('maximumInvestment').innerText =
      `${maxLots} ${maxLots <= 1 ? "Lot" : "Lots"} / ₹ ${totalMaxInvestment.toLocaleString()}`;
      lotsvalue
      lotsvalue=maxLots
  }
};



function redirect(){
  const parametersObject = getDecryptedData();
   
   const applydata={
  
    investortype:investorType,
    ipoSymbol:parametersObject.ipoSymbol,
    isCompanyFrom:parametersObject.isCompanyFrom,
    isin:parametersObject.isin
   }
   var jsonString = JSON.stringify(applydata);

   var secretKey = "ipodetailsdata01"; // Choose a strong key
  var encrypted = CryptoJS.AES.encrypt(jsonString, secretKey).toString();
  var encoded = encodeURIComponent(encrypted);
  console.log(encoded)
  window.location.href = `applyNow.html?data=${encoded}`
}


  </script>
</body>

</html>